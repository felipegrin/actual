import{j as e,r as T,V as l,t as a,o as Ue,am as ae,at as Te,au as Ce,aw as z,aR as qe,aS as ee,aT as ze,ax as Re,aU as te,K as Me,aV as D,aF as ke,aW as Y,aX as G,aY as W,aZ as H,T as C,U as Le,s as A,aB as De,a_ as Ye,a$ as J,b0 as Ke,ao as Xe,ai as U,ag as ne,n as xe,b1 as He,b2 as Je,b3 as Ze,aN as Ge,b4 as P,b5 as $,X as et,G as tt,b6 as ve,b7 as $e,b8 as nt,A as it,b9 as ot,ba as st,bb as at,y as Z,bc as we,bd as rt,be as lt,bf as dt,bg as Pe,bh as ct,bi as Ae,bj as ut,bk as xt,a5 as gt,bl as mt,Y as ft,bm as Be,bn as Ee,bo as ht,bp as pt,bq as Ne,br as yt,bs as bt,bt as Oe,bu as jt,bv as St,bw as wt,aD as Tt,bx as Ct,by as vt,bz as Bt,bA as It,bB as kt,bC as Pt,bD as At,bE as Ft,bF as Wt,bG as zt,bH as Rt,bI as Mt,bJ as Lt,bK as Dt,bL as Ht,bM as Gt,bN as $t,bO as Et,bP as Nt}from"./index.D3b5Q86n.js";import{u as Ot}from"./usePreviewTransactions.fBVa-E_f.chunk.js";const Vt=t=>e.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",style:{color:"inherit",...t.style},children:e.jsx("path",{d:"M10 7H2v6h8v5l8-8-8-8v5z",fill:"currentColor"})}),_t=t=>e.jsx("svg",{...t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",style:{color:"inherit",...t.style},children:e.jsx("path",{d:"m3.828 9 6.071-6.071-1.414-1.414L0 10l.707.707 7.778 7.778 1.414-1.414L3.828 11H20V9H3.828z",fill:"currentColor"})});function Qt({onSync:t,children:n}){const[i,s]=T.useState(!1);async function c(){s(!0),await t(),s(!1)}return e.jsx(e.Fragment,{children:n({refreshing:i,onRefresh:c})})}const Ie=T.forwardRef(({children:t,...n},i)=>e.jsx(l,{...n,ref:i,style:{marginTop:15,marginLeft:5,marginRight:5,borderRadius:6,backgroundColor:a.cardBackground,borderColor:a.cardBorder,boxShadow:"0 1px 2px #9594A8",...n.style},children:e.jsx(l,{style:{borderRadius:6,overflow:"hidden"},children:t})}));Ie.displayName="Card";const Ut=50,ge=({children:t,style:n,...i})=>e.jsx(l,{style:{height:Ut,borderBottomWidth:1,borderColor:a.tableBorder,flexDirection:"row",alignItems:"center",paddingLeft:5,paddingRight:5,zIndex:1,...n},...i,children:t}),ue={borderRadius:16,color:a.pillText,backgroundColor:a.pillBackgroundLight};function O({show3Cols:t,isSidebar:n=!1,offset:i=0}={}){return n?t?`${35+i}vw`:`${45+i}vw`:t?`${20+i}vw`:`${25+i}vw`}function qt({toBudget:t,onPress:n,show3Cols:i}){const s=J(t),c=te(),f=O({show3Cols:i,isSidebar:!0});return e.jsx(l,{style:{flexDirection:"row",justifyContent:"flex-start",alignItems:"center",width:f},children:e.jsxs(z,{variant:"bare",style:{maxWidth:f},onPress:n,children:[e.jsxs(l,{children:[e.jsx(Y,{title:s<0?"Overbudgeted":"To Budget",style:{...s<0?A.smallText:{},color:a.formInputText,flexShrink:0,textAlign:"left"}}),e.jsx(G,{binding:t,type:"financial",formatter:r=>e.jsx(H,{as:C,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:f,fontSize:12,fontWeight:"700",color:s<0?a.errorText:a.formInputText},children:c(r,"financial")},r)})]}),e.jsx(ee,{style:{flexShrink:0,color:a.mobileHeaderTextSubdued,marginLeft:5},width:14,height:14})]})})}function Yt({projected:t,onPress:n,show3Cols:i}){const s=t?W.totalBudgetedSaved:W.totalSaved,c=J(s)||0,f=te(),r=c<0,g=O({show3Cols:i,isSidebar:!0});return e.jsx(l,{style:{flexDirection:"row",justifyContent:"flex-start",alignItems:"center",width:g},children:e.jsxs(z,{variant:"bare",style:{maxWidth:g},onPress:n,children:[e.jsxs(l,{children:[e.jsx(l,{children:t?e.jsx(H,{as:Y,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",title:"Projected Savings",style:{maxWidth:g,color:a.formInputText,textAlign:"left",fontSize:12}}):e.jsx(Y,{title:r?"Overspent":"Saved",style:{color:a.formInputText,textAlign:"left"}})}),e.jsx(G,{binding:s,type:"financial",formatter:m=>e.jsx(H,{as:C,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:g,fontSize:12,fontWeight:"700",color:t?a.warningText:r?a.errorTextDark:a.formInputText},children:f(m,"financial")},m)})]}),e.jsx(ee,{style:{flexShrink:0,color:a.mobileHeaderTextSubdued,marginLeft:5},width:14,height:14})]})})}function Ve({name:t,binding:n,style:i,categoryId:s,month:c,onBudgetAction:f,...r}){const g=ne(),[m="rollover"]=U("budgetType"),p=`${m}-budget-menu`,u=()=>{g(P(p,{categoryId:s,month:c,onUpdateBudget:h=>{f(c,"budget-amount",{category:s,amount:h})},onCopyLastMonthAverage:()=>{f(c,"copy-single-last",{category:s})},onSetMonthsAverage:h=>{h!==3&&h!==6&&h!==12||f(c,`set-single-${h}-avg`,{category:s})},onApplyBudgetTemplate:()=>{f(c,"apply-single-category-template",{category:s})}}))};return e.jsx(G,{binding:n,type:"financial",getStyle:He,"data-testid":t,onPointerUp:h=>{h.stopPropagation(),u()},...r})}const Kt=T.memo(function({type:n,category:i,isHidden:s,goal:c,longGoal:f,budgeted:r,spent:g,balance:m,carryover:p,index:u,blank:h,style:y,month:x,onEdit:L,onBudgetAction:o,show3Cols:S,showBudgetedCol:I}){const k=h?0:1,M=Xe("goalTemplatesEnabled"),_=J(c),V=M?_:null,[w="rollover"]=U("budgetType"),F=ne(),q=B=>{o(x,"carryover",{category:i.id,flag:B}),F($(`${w}-balance-menu`))},K=J(n==="rollover"?D.catBalance(i.id):W.catBalance(i.id)),X=J(r),v=J(m),E=J(f)===1,N=M?E?v:X:null,ie=()=>{F(P("transfer",{title:i.name,month:x,amount:K,onSubmit:(B,je)=>{o(x,"transfer-category",{amount:B,from:i.id,to:je}),F($(`${w}-balance-menu`))},showToBeBudgeted:!0}))},me=()=>{F(P("cover",{title:i.name,month:x,category:i.id,onSubmit:B=>{o(x,"cover-overspending",{to:i.id,from:B}),F($(`${w}-balance-menu`))}}))},fe=()=>{F(P(`${w}-balance-menu`,{categoryId:i.id,month:x,onCarryover:q,...w==="rollover"&&{onTransfer:ie,onCover:me}}))},he=T.useRef(),oe=te(),pe=xe(),ye=()=>{pe(`/categories/${i.id}?month=${x}`)},re=O({show3Cols:S,isSidebar:!0}),Q=O({show3Cols:S}),be=e.jsxs(ge,{style:{backgroundColor:"transparent",borderBottomWidth:0,borderTopWidth:u>0?1:0,opacity:s?.5:void 0,...y},"data-testid":"row",innerRef:he,children:[e.jsx(l,{style:{flex:1,justifyContent:"center",alignItems:"flex-start"},children:e.jsx(z,{variant:"bare",style:{maxWidth:re},onPress:()=>L?.(i.id),children:e.jsxs(l,{style:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},children:[e.jsx(C,{style:{...A.lineClamp(2),width:re,textAlign:"left",...A.smallText},"data-testid":"category-name",children:i.name}),e.jsx(ee,{style:{flexShrink:0,color:a.tableTextSubdued},width:14,height:14})]})})}),e.jsxs(l,{style:{justifyContent:"center",alignItems:"center",flexDirection:"row",opacity:k},children:[e.jsx(l,{style:{...!S&&!I&&{display:"none"},width:Q,justifyContent:"center",alignItems:"flex-end"},children:e.jsx(Ve,{name:"budgeted",binding:r,categoryId:i.id,month:x,onBudgetAction:o,formatter:B=>e.jsx(z,{variant:"bare",style:{...ue,maxWidth:Q},children:e.jsx(H,{as:C,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:Q,textAlign:"right",fontSize:12},children:oe(B,"financial")},`${B}|${S}|${I}`)})})}),e.jsx(l,{style:{...!S&&I&&{display:"none"},justifyContent:"center",alignItems:"flex-end",width:Q},children:e.jsx(G,{name:"spent",binding:g,getStyle:He,type:"financial",onPointerUp:B=>{B.stopPropagation(),ye()},formatter:B=>e.jsx(z,{variant:"bare",style:{...ue,maxWidth:Q},children:e.jsx(H,{as:C,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:Q,textAlign:"right",fontSize:12},children:oe(B,"financial")},`${B}|${S}|${I}`)})})}),e.jsx(l,{style:{...A.noTapHighlight,justifyContent:"center",alignItems:"flex-end",width:Q},children:e.jsx("span",{role:"button",onPointerUp:B=>{B.stopPropagation(),fe()},children:e.jsx(Je,{carryover:p,balance:m,goal:c,budgeted:r,longGoal:f,formatter:B=>e.jsx(z,{variant:"bare",style:{...ue,maxWidth:Q},children:e.jsx(H,{as:C,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:Q,...Ze(B,V,N),textAlign:"right",fontSize:12},children:oe(B,"financial")},B)}),carryoverIndicator:({style:B})=>e.jsx(l,{style:{position:"absolute",right:"-3px",top:"-5px",borderRadius:"50%",backgroundColor:B?.color??a.pillText},children:e.jsx(Vt,{width:11,height:11,style:{color:a.pillBackgroundLight}})})})})})]})]});return e.jsx(l,{children:be})}),Xt=T.memo(function({group:n,budgeted:i,spent:s,balance:c,editMode:f,onEdit:r,blank:g,show3Cols:m,showBudgetedCol:p,collapsed:u,onToggleCollapse:h}){const y=g?0:1,x=T.useRef(),L=te(),o=O({show3Cols:m,isSidebar:!0,offset:-3.5}),S=O({show3Cols:m}),I=e.jsxs(ge,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:a.tableRowHeaderBackground,opacity:n.hidden?.5:void 0,paddingLeft:0},"data-testid":`expense-group-header-${n.name}`,innerRef:x,children:[e.jsxs(l,{style:{flex:1,flexDirection:"row",justifyContent:"flex-start",width:o},children:[e.jsx(z,{variant:"bare",style:({isPressed:k,isHovered:M})=>({flexShrink:0,color:a.pageTextSubdued,...A.noTapHighlight,...k||M?{backgroundColor:"transparent"}:{}}),onPress:()=>h?.(n.id),children:e.jsx(Ge,{width:8,height:8,style:{flexShrink:0,transition:"transform .1s",transform:u?"rotate(-90deg)":""}})}),e.jsx(z,{variant:"bare",style:{maxWidth:o},onPress:()=>r?.(n.id),children:e.jsxs(l,{style:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},children:[e.jsx(C,{style:{...A.lineClamp(2),width:o,textAlign:"left",...A.smallText,fontWeight:"500"},"data-testid":"group-name",children:n.name}),e.jsx(ee,{style:{flexShrink:0,color:a.tableTextSubdued},width:14,height:14})]})})]}),e.jsxs(l,{style:{flexDirection:"row",justifyContent:"flex-end",alignItems:"center",opacity:y,paddingRight:5},children:[e.jsx(l,{style:{...!m&&!p&&{display:"none"},width:S,justifyContent:"center",alignItems:"flex-end"},children:e.jsx(G,{binding:i,type:"financial",formatter:k=>e.jsx(H,{as:C,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:S,fontSize:12,fontWeight:"500",paddingLeft:5,textAlign:"right"},children:L(k,"financial")},k)})}),e.jsx(l,{style:{...!m&&p&&{display:"none"},width:S,justifyContent:"center",alignItems:"flex-end"},children:e.jsx(G,{binding:s,type:"financial",formatter:k=>e.jsx(H,{as:C,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:S,fontSize:12,fontWeight:"500",paddingLeft:5,textAlign:"right"},children:L(k,"financial")},k)})}),e.jsx(l,{style:{width:S,justifyContent:"center",alignItems:"flex-end"},children:e.jsx(G,{binding:c,type:"financial",formatter:k=>e.jsx(H,{as:C,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:S,fontSize:12,fontWeight:"500",paddingLeft:5,textAlign:"right"},children:L(k,"financial")},k)})})]})]});return I}),Jt=T.memo(function({group:n,budgeted:i,balance:s,onEdit:c,collapsed:f,onToggleCollapse:r}){const g=T.useRef(),m=te(),p=O({isSidebar:!0,offset:-13.5}),u=O();return e.jsxs(ge,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:a.tableRowHeaderBackground,opacity:n.hidden?.5:void 0,paddingLeft:0},innerRef:g,"data-testid":`income-group-header-${n.name}`,children:[e.jsxs(l,{style:{flex:1,flexDirection:"row",justifyContent:"flex-start",width:p},children:[e.jsx(z,{variant:"bare",style:({isPressed:h,isHovered:y})=>({flexShrink:0,color:a.pageTextSubdued,...A.noTapHighlight,...h||y?{backgroundColor:"transparent"}:{}}),onPress:()=>r?.(n.id),children:e.jsx(Ge,{width:8,height:8,style:{flexShrink:0,transition:"transform .1s",transform:f?"rotate(-90deg)":""}})}),e.jsx(z,{variant:"bare",style:{maxWidth:p},onPress:()=>c?.(n.id),children:e.jsxs(l,{style:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},children:[e.jsx(C,{style:{...A.lineClamp(2),width:p,textAlign:"left",...A.smallText},"data-testid":"group-name",children:n.name}),e.jsx(ee,{style:{flexShrink:0,color:a.tableTextSubdued},width:14,height:14})]})})]}),e.jsxs(l,{style:{flexDirection:"row",justifyContent:"flex-end",alignItems:"center",paddingRight:5},children:[i&&e.jsx(l,{style:{justifyContent:"center",alignItems:"flex-end",width:u},children:e.jsx(G,{binding:i,type:"financial",formatter:h=>e.jsx(H,{as:C,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:u,paddingLeft:5,textAlign:"right",fontSize:12,fontWeight:"500"},children:m(h,"financial")},h)})}),e.jsx(l,{style:{justifyContent:"center",alignItems:"flex-end",width:u},children:e.jsx(G,{binding:s,type:"financial",formatter:h=>e.jsx(H,{as:C,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:u,paddingLeft:5,textAlign:"right",fontSize:12,fontWeight:"500"},children:m(h,"financial")},h)})})]})]})}),Zt=T.memo(function({index:n,category:i,budgeted:s,balance:c,month:f,style:r,onEdit:g,onBudgetAction:m}){const p=T.useRef(),u=te(),h=O({isSidebar:!0,offset:-10}),y=O();return e.jsxs(ge,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"transparent",borderBottomWidth:0,borderTopWidth:n>0?1:0,opacity:i.hidden?.5:void 0,...r},"data-testid":"row",innerRef:p,children:[e.jsx(l,{style:{flex:1,justifyContent:"center",alignItems:"flex-start",width:h},children:e.jsx(z,{variant:"bare",style:{maxWidth:h},onPress:()=>g?.(i.id),children:e.jsxs(l,{style:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start"},children:[e.jsx(C,{style:{...A.lineClamp(2),width:h,textAlign:"left",...A.smallText},"data-testid":"category-name",children:i.name}),e.jsx(ee,{style:{flexShrink:0,color:a.tableTextSubdued},width:14,height:14})]})})}),e.jsxs(l,{style:{flexDirection:"row",justifyContent:"flex-end",alignItems:"center"},children:[s&&e.jsx(l,{style:{width:y,justifyContent:"center",alignItems:"flex-end"},children:e.jsx(Ve,{name:"budgeted",binding:s,categoryId:i.id,month:f,onBudgetAction:m,formatter:x=>e.jsx(z,{variant:"bare",style:{...ue,maxWidth:y},children:e.jsx(H,{as:C,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:y,textAlign:"right",fontSize:12},children:u(x,"financial")},x)})})}),e.jsx(l,{style:{justifyContent:"center",alignItems:"flex-end",width:y,paddingRight:5},children:e.jsx(G,{binding:c,type:"financial",formatter:x=>e.jsx(H,{as:C,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:y,textAlign:"right",fontSize:12},children:u(x,"financial")},x)})})]})]})}),en=T.memo(function({type:n,group:i,editMode:s,onEditGroup:c,onEditCategory:f,month:r,onAddCategory:g,onBudgetAction:m,showBudgetedCol:p,show3Cols:u,showHiddenCategories:h,collapsed:y,onToggleCollapse:x}){function L(o){return o}return e.jsxs(Ie,{style:{marginTop:4,marginBottom:4},children:[e.jsx(Xt,{group:i,showBudgetedCol:p,budgeted:n==="report"?W.groupBudgeted(i.id):D.groupBudgeted(i.id),spent:n==="report"?W.groupSumAmount(i.id):D.groupSumAmount(i.id),balance:n==="report"?W.groupBalance(i.id):D.groupBalance(i.id),show3Cols:u,editMode:s,onAddCategory:g,onEdit:c,collapsed:y,onToggleCollapse:x}),i.categories.filter(o=>!y&&(!o.hidden||h)).map((o,S)=>e.jsx(Kt,{index:S,show3Cols:u,type:n,category:o,isHidden:!!o.hidden||i.hidden,goal:n==="report"?W.catGoal(o.id):D.catGoal(o.id),longGoal:n==="report"?W.catLongGoal(o.id):D.catLongGoal(o.id),budgeted:n==="report"?W.catBudgeted(o.id):D.catBudgeted(o.id),spent:n==="report"?W.catSumAmount(o.id):D.catSumAmount(o.id),balance:n==="report"?W.catBalance(o.id):D.catBalance(o.id),carryover:n==="report"?W.catCarryover(o.id):D.catCarryover(o.id),style:{backgroundColor:a.tableBackground},showBudgetedCol:p,editMode:s,onEdit:f,month:r,onBudgetAction:m},o.id))]})});function tn({type:t,group:n,month:i,onAddCategory:s,showHiddenCategories:c,editMode:f,onEditGroup:r,onEditCategory:g,onBudgetAction:m,collapsed:p,onToggleCollapse:u}){const h=O();return e.jsxs(l,{children:[e.jsxs(l,{style:{flexDirection:"row",alignItems:"center",justifyContent:"flex-end",marginTop:50,marginBottom:5,marginRight:15},children:[t==="report"&&e.jsx(Y,{title:"Budgeted",style:{width:h}}),e.jsx(Y,{title:"Received",style:{width:h}})]}),e.jsxs(Ie,{style:{marginTop:0},children:[e.jsx(Jt,{group:n,budgeted:t==="report"?W.groupBudgeted(n.id):null,balance:t==="report"?W.groupSumAmount(n.id):D.groupSumAmount(n.id),onAddCategory:s,editMode:f,onEdit:r,collapsed:p,onToggleCollapse:u}),n.categories.filter(y=>!p&&(!y.hidden||c)).map((y,x)=>e.jsx(Zt,{index:x,category:y,month:i,type:t,budgeted:t==="report"?W.catBudgeted(y.id):null,balance:t==="report"?W.catSumAmount(y.id):D.catSumAmount(y.id),style:{backgroundColor:a.tableBackground},editMode:f,onEdit:g,onBudgetAction:m},y.id))]})]})}function nn({type:t,categoryGroups:n,onEditGroup:i,onEditCategory:s,editMode:c,gestures:f,month:r,onSaveCategory:g,onDeleteCategory:m,onAddCategory:p,onReorderCategory:u,onReorderGroup:h,onBudgetAction:y,showBudgetedCol:x,show3Cols:L,showHiddenCategories:o}){const S=Ke(w=>({incomeGroup:w.find(F=>F.is_income),expenseGroups:w.filter(F=>!F.is_income)})),{incomeGroup:I,expenseGroups:k}=S(n),[M=[],_]=ae("budget.collapsed"),V=w=>{_(M.includes(w)?M.filter(F=>F!==w):[...M,w])};return e.jsxs(l,{"data-testid":"budget-groups",style:{flex:"1 0 auto",overflowY:"auto",paddingBottom:15},children:[k.filter(w=>!w.hidden||o).map(w=>e.jsx(en,{type:t,group:w,showBudgetedCol:x,gestures:f,month:r,editMode:c,onEditGroup:i,onEditCategory:s,onSaveCategory:g,onDeleteCategory:m,onAddCategory:p,onReorderCategory:u,onReorderGroup:h,onBudgetAction:y,show3Cols:L,showHiddenCategories:o,collapsed:M.includes(w.id),onToggleCollapse:V},w.id)),I&&e.jsx(tn,{type:t,group:I,month:r,onAddCategory:p,onSaveCategory:g,onDeleteCategory:m,showHiddenCategories:o,editMode:c,onEditGroup:i,onEditCategory:s,onBudgetAction:y,collapsed:M.includes(I.id),onToggleCollapse:V})]})}function on({type:t,categoryGroups:n,month:i,monthBounds:s,onPrevMonth:c,onNextMonth:f,onSaveGroup:r,onDeleteGroup:g,onAddCategory:m,onSaveCategory:p,onDeleteCategory:u,onReorderCategory:h,onReorderGroup:y,onShowBudgetSummary:x,onBudgetAction:L,onRefresh:o,onEditGroup:S,onEditCategory:I,onOpenBudgetPageMenu:k,onOpenBudgetMonthMenu:M}){const{width:_}=Ue(),V=_>=360,[w=!1,F]=ae("mobile.showSpentColumn");function q(){F(!w)}const[K=!1]=ae("budget.showHiddenCategories"),X={backgroundColor:"transparent",color:"white"};return e.jsxs(Te,{padding:0,header:e.jsx(Ce,{title:e.jsx(an,{month:i,monthBounds:s,onOpenMonthMenu:M,onPrevMonth:c,onNextMonth:f}),leftContent:e.jsxs(z,{variant:"bare",style:({isPressed:v,isHovered:E})=>({color:a.mobileHeaderText,margin:10,...v||E?X:{}}),onPress:k,children:[e.jsx(qe,{width:"20",height:"20"}),e.jsx(ee,{style:{flexShrink:0,color:a.mobileHeaderTextSubdued},width:"14",height:"14"})]})}),children:[e.jsx(sn,{type:t,month:i,show3Cols:V,showSpentColumn:w,toggleSpentColumn:q,onShowBudgetSummary:x}),e.jsx(ze,{onRefresh:o,children:e.jsx(l,{"data-testid":"budget-table",style:{backgroundColor:a.pageBackground,paddingBottom:Re},children:e.jsx(nn,{type:t,categoryGroups:n,showBudgetedCol:!w,show3Cols:V,showHiddenCategories:K,month:i,onEditGroup:S,onEditCategory:I,onSaveCategory:p,onDeleteCategory:u,onAddCategory:m,onSaveGroup:r,onDeleteGroup:g,onReorderCategory:h,onReorderGroup:y,onBudgetAction:L})})})]})}function sn({show3Cols:t,type:n,month:i,onShowBudgetSummary:s,showSpentColumn:c,toggleSpentColumn:f}){const r=te(),g={padding:0,backgroundColor:"transparent",borderRadius:"unset"},m=O({show3Cols:t,isSidebar:!0}),p=O({show3Cols:t});return e.jsxs(l,{style:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexShrink:0,padding:"10px 15px",paddingLeft:10,backgroundColor:a.tableRowHeaderBackground,borderBottomWidth:1,borderColor:a.tableBorder},children:[e.jsx(l,{style:{width:m,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"},children:n==="report"?e.jsx(Yt,{projected:i>=Me(),onPress:s,show3Cols:t}):e.jsx(qt,{toBudget:D.toBudget,onPress:s,show3Cols:t})}),e.jsxs(l,{style:{flexDirection:"row",justifyContent:"flex-end",alignItems:"center"},children:[(t||!c)&&e.jsx(l,{style:{width:p,alignItems:"flex-end"},children:e.jsx(z,{variant:"bare",isDisabled:t,onPress:f,style:g,children:e.jsxs(l,{style:{alignItems:"flex-end"},children:[e.jsxs(l,{style:{flexDirection:"row",alignItems:"center"},children:[!t&&e.jsx(ke,{width:12,height:12,style:{color:a.pageTextSubdued,marginRight:5}}),e.jsx(Y,{title:"Budgeted",style:{color:a.formInputText}})]}),e.jsx(G,{binding:n==="report"?W.totalBudgetedExpense:D.totalBudgeted,type:"financial",formatter:u=>e.jsx(H,{as:C,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:p,color:a.formInputText,paddingLeft:5,textAlign:"right",fontSize:12,fontWeight:"500"},children:r(u,"financial")},u)})]})})}),(t||c)&&e.jsx(l,{style:{width:p,alignItems:"flex-end"},children:e.jsx(z,{variant:"bare",isDisabled:t,onPress:f(),style:g,children:e.jsxs(l,{style:{alignItems:"flex-end"},children:[e.jsxs(l,{style:{flexDirection:"row",alignItems:"center"},children:[!t&&e.jsx(ke,{width:12,height:12,style:{color:a.pageTextSubdued,marginRight:5}}),e.jsx(Y,{title:"Spent",style:{color:a.formInputText}})]}),e.jsx(G,{binding:n==="report"?W.totalSpent:D.totalSpent,type:"financial",formatter:u=>e.jsx(H,{as:C,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:p,color:a.formInputText,paddingLeft:5,textAlign:"right",fontSize:12,fontWeight:"500"},children:r(u,"financial")},u)})]})})}),e.jsxs(l,{style:{width:p,alignItems:"flex-end"},children:[e.jsx(Y,{title:"Balance",style:{color:a.formInputText}}),e.jsx(G,{binding:n==="report"?W.totalLeftover:D.totalBalance,type:"financial",formatter:u=>e.jsx(H,{as:C,minFontSizePx:6,maxFontSizePx:12,mode:"oneline",style:{maxWidth:p,color:a.formInputText,paddingLeft:5,textAlign:"right",fontSize:12,fontWeight:"500"},children:r(u,"financial")},u)})]})]})]})}function an({month:t,monthBounds:n,onOpenMonthMenu:i,onPrevMonth:s,onNextMonth:c}){const f=t>n.start,r=t<Le(n.end,1),g={padding:10,margin:2};return e.jsxs(l,{style:{flex:1,justifyContent:"center",alignItems:"center",flexDirection:"row"},children:[e.jsx(z,{variant:"bare",onPress:()=>{f&&s()},style:({isHovered:m})=>({...A.noTapHighlight,...g,opacity:f?1:.6,color:a.mobileHeaderText,...m?{color:a.mobileHeaderText,background:a.mobileHeaderTextHover}:{}}),children:e.jsx(_t,{width:"15",height:"15",style:{margin:-5}})}),e.jsx(C,{style:{color:a.mobileHeaderText,textAlign:"center",fontSize:16,fontWeight:500,margin:"0 5px",...A.underlinedText},onPointerUp:m=>{m.stopPropagation(),i?.(t)},children:De(t,"MMMM ‘yy")}),e.jsx(z,{variant:"bare",onPress:()=>{r&&c()},style:({isHovered:m})=>({...A.noTapHighlight,...g,opacity:r?1:.6,color:a.mobileHeaderText,...m?{color:a.mobileHeaderText,background:a.mobileHeaderTextHover}:{}}),children:e.jsx(Ye,{width:"15",height:"15",style:{margin:-5}})})]})}function rn(t){const{categoryGroups:n,categories:i,budgetType:s,spreadsheet:c}=t,f=Me(),[r=f,g]=ae("budget.startMonth"),[m,p]=T.useState({start:r,end:r}),[u,h]=T.useState(!1),[y]=U("numberFormat"),x=y||"comma-dot",[L=!1]=U("hideFraction"),o=ne();T.useEffect(()=>{async function d(){const{start:j,end:R}=await Z("get-budget-bounds");p({start:j,end:R}),await we(s,c,r),h(!0)}d();const b=$e("sync-event",({type:j,tables:R})=>{j==="success"&&(R.includes("categories")||R.includes("category_mapping")||R.includes("category_groups"))&&o(nt())});return()=>b()},[s,r,o,c]);const S=async(d,b,j)=>{o(rt(d,b,j))},I=()=>{o(s==="report"?P("report-budget-summary",{month:r}):P("rollover-budget-summary",{month:r,onBudgetAction:S}))},k=()=>{o(P("new-category-group",{onValidate:d=>d?null:"Name is required.",onSubmit:async d=>{o($("budget-page-menu")),o(mt(d))}}))},M=(d,b)=>{o(P("new-category",{onValidate:j=>j?null:"Name is required.",onSubmit:async j=>{o($("category-group-menu")),o(lt(j,d,b,!1))}}))},_=d=>{o(dt(d))},V=async d=>{const b=n?.find(R=>R.id===d);if(!b)return;let j=!1;for(const R of b.categories??[])if(await Z("must-category-transfer",{id:R.id})){j=!0;break}j?o(P("confirm-category-delete",{group:d,onDelete:R=>{o($("category-group-menu")),o(Pe(d,R))}})):(o($("category-group-menu")),o(Pe(d)))},w=d=>{const b=n.find(j=>j.id===d);_({...b,hidden:!b.hidden}),o($("category-group-menu"))},F=d=>{o(ct(d))},q=async d=>{await Z("must-category-transfer",{id:d})?o(P("confirm-category-delete",{category:d,onDelete:j=>{d!==j&&(o($("category-menu")),o(Ae(d,j)))}})):(o($("category-menu")),o(Ae(d)))},K=d=>{const b=i.find(j=>j.id===d);F({...b,hidden:!b.hidden}),o($("category-menu"))},X=(d,{inGroup:b,aroundCategory:j})=>{let R,le;if(b)R=b;else if(j){const{id:_e,position:Qe}=j;let de=_e;const se=n.find(ce=>ce.categories?.find(Se=>Se.id===de));if(Qe==="bottom"){const ce=se?.categories?.findIndex(Se=>Se.id===de)??-1;de=se?.categories&&ce<se.categories.length-1?se.categories[ce+1].id:null}R=se?.id,le=de}o(ut(d,R,le))},v=(d,b,j)=>{if(j==="bottom"){const R=n.findIndex(le=>le.id===b);b=R<n.length-1?n[R+1].id:null}o(xt(d,b))},E=async()=>{const d=Le(r,1);await we(s,c,d),g(d),h(!0)},N=async()=>{const d=gt(r,1);await we(s,c,d),g(d),h(!0)},ie=async(d,b)=>{await Z("notes-save",{id:d,note:b})},me=d=>{const b=n.find(j=>j.id===d);o(P("notes",{id:d,name:b.name,onSave:ie}))},fe=d=>{const b=i.find(j=>j.id===d);o(P("notes",{id:d,name:b.name,onSave:ie}))},he=d=>{const b=n.find(j=>j.id===d);o(P("category-group-menu",{groupId:b.id,onSave:_,onAddCategory:M,onEditNotes:me,onDelete:V,onToggleVisibility:w}))},oe=d=>{const b=i.find(j=>j.id===d);o(P("category-menu",{categoryId:b.id,onSave:F,onEditNotes:fe,onDelete:q,onToggleVisibility:K,onBudgetAction:S}))},[pe,ye]=ae("budget.showHiddenCategories"),re=()=>{ye(!pe),o($("budget-page-menu"))},Q=d=>{o(P("notes",{id:`budget-${d}`,name:De(d,"MMMM ‘yy"),onSave:ie}))},be=()=>{o(P("budget-list"))},B=d=>{o(P(`${s}-budget-month-menu`,{month:d,onBudgetAction:S,onEditNotes:Q}))},je=()=>{o(P("budget-page-menu",{onAddCategoryGroup:k,onToggleHiddenCategories:re,onSwitchBudgetFile:be}))};return!n||!u?e.jsx(l,{style:{flex:1,backgroundColor:a.mobilePageBackground,alignItems:"center",justifyContent:"center",marginBottom:25},children:e.jsx(it,{width:25,height:25})}):e.jsx(ot.Provider,{value:st(r),children:e.jsx(Qt,{onSync:async()=>{o(at())},children:({onRefresh:d})=>e.jsx(on,{categoryGroups:n,type:s,month:r,monthBounds:m,onShowBudgetSummary:I,onPrevMonth:E,onNextMonth:N,onSaveGroup:_,onDeleteGroup:V,onAddCategory:M,onSaveCategory:F,onDeleteCategory:q,onReorderCategory:X,onReorderGroup:v,onBudgetAction:S,onRefresh:d,onEditGroup:he,onEditCategory:oe,onOpenBudgetPageMenu:je,onOpenBudgetMonthMenu:B},`${x}${L}`)})})}function fn(){const{list:t,grouped:n}=et(),[i="rollover"]=U("budgetType"),s=tt();return ve(a.mobileViewTheme),e.jsx(rn,{categoryGroups:n,categories:t,budgetType:i,spreadsheet:s})}function Fe({name:t,amount:n,style:i={}}){return e.jsxs(l,{style:{flex:1,flexDirection:"row",marginTop:10,marginRight:10,color:a.pageTextLight,width:"100%",...i},children:[e.jsx(l,{style:{flex:1},children:e.jsx(C,{style:{...A.text,fontSize:14},"data-testid":"name",children:t})}),e.jsx(G,{binding:n,style:{...A.text,fontSize:14},type:"financial"})]})}function We({account:t,updated:n,connected:i,pending:s,failed:c,getBalanceQuery:f,onSelect:r}){return e.jsx(l,{style:{flex:1,flexDirection:"row",backgroundColor:a.tableBackground,boxShadow:`0 1px 1px ${a.mobileAccountShadow}`,borderRadius:6,marginTop:10,marginRight:10,width:"100%"},"data-testid":"account",children:e.jsxs(z,{onPress:()=>r(t.id),style:({isPressed:g})=>({flexDirection:"row",border:"1px solid "+a.pillBorder,flex:1,alignItems:"center",borderRadius:6,...g&&{opacity:.1}}),children:[e.jsx(l,{style:{flex:1,margin:"10px 0"},children:e.jsxs(l,{style:{flexDirection:"row",alignItems:"center"},children:[t.bankId&&e.jsx(l,{style:{backgroundColor:s?a.sidebarItemBackgroundPending:c?a.sidebarItemBackgroundFailed:a.sidebarItemBackgroundPositive,marginRight:"8px",width:8,flexShrink:0,height:8,borderRadius:8,opacity:i?1:0}}),e.jsx(jt,{style:{...A.text,fontSize:17,fontWeight:600,color:n?a.mobileAccountText:a.pillText,paddingRight:30},"data-testid":"account-name",children:t.name})]})}),e.jsx(G,{binding:f(t),type:"financial",style:{fontSize:16,color:"inherit"},getStyle:St,"data-testid":"account-balance"})]})})}function ln(){return e.jsx(l,{style:{flex:1,padding:30},children:e.jsx(C,{style:A.text,children:"For Actual to be useful, you need to add an account. You can link an account to automatically download transactions, or manage it locally yourself."})})}function dn({accounts:t,updatedAccounts:n,getBalanceQuery:i,getOnBudgetBalance:s,getOffBudgetBalance:c,onAddAccount:f,onSelectAccount:r,onSync:g}){const m=Ne(),p=Be(x=>x.account.accountsSyncing),u=t.filter(x=>x.offbudget===0),h=t.filter(x=>x.offbudget===1),y={backgroundColor:"transparent",color:"white"};return e.jsxs(Te,{header:e.jsx(Ce,{title:"Accounts",rightContent:e.jsx(z,{variant:"bare",style:({isHovered:x,isPressed:L})=>({color:a.mobileHeaderText,margin:10,...x||L?y:{}}),onPress:f,children:e.jsx(yt,{width:20,height:20})})}),padding:0,style:{paddingBottom:Re},children:[t.length===0&&e.jsx(ln,{}),e.jsx(ze,{onRefresh:g,children:e.jsxs(l,{style:{margin:10},children:[u.length>0&&e.jsx(Fe,{name:"For Budget",amount:s()}),u.map(x=>e.jsx(We,{account:x,updated:n&&n.includes(x.id),connected:!!x.bank,pending:p.includes(x.id),failed:m&&m.has(x.id),getBalanceQuery:i,onSelect:r},x.id)),h.length>0&&e.jsx(Fe,{name:"Off Budget",amount:c(),style:{marginTop:30}}),h.map(x=>e.jsx(We,{account:x,updated:n&&n.includes(x.id),connected:!!x.bank,pending:p.includes(x.id),failed:m&&m.has(x.id),getBalanceQuery:i,onSelect:r},x.id))]})})]})}function hn(){const t=ne(),n=ft(),i=Be(u=>u.queries.updatedAccounts),[s]=U("numberFormat"),c=s||"comma-dot",[f=!1]=U("hideFraction"),r=xe(),g=u=>{r(`/accounts/${u}`)},m=()=>{t(bt("add-account"))},p=()=>{t(Oe())};return ve(a.mobileViewTheme),e.jsx(l,{style:{flex:1},children:e.jsx(dn,{accounts:n.filter(u=>!u.closed),updatedAccounts:i,getBalanceQuery:Ee,getOnBudgetBalance:ht,getOffBudgetBalance:pt,onAddAccount:m,onSelectAccount:g,onSync:p},c+f)})}function cn({account:t,pending:n,failed:i}){const s=wt(t.id);return e.jsx(Te,{header:e.jsx(Ce,{title:e.jsx(un,{account:t,pending:n,failed:i}),leftContent:e.jsx(Tt,{}),rightContent:e.jsx(Ct,{accountId:t.id})}),padding:0,children:e.jsx(vt,{transform:s,children:e.jsx(xn,{account:t})})})}function un({account:t,pending:n,failed:i}){const s=ne(),c=u=>{s(Dt(u))},f=async(u,h)=>{await Z("notes-save",{id:u,note:h})},r=u=>{s(P("notes",{id:`account-${u}`,name:t.name,onSave:f}))},g=()=>{s(Ht(t.id))},m=()=>{s(Gt(t.id))},p=()=>{s(P("account-menu",{accountId:t.id,onSave:c,onEditNotes:r,onCloseAccount:g,onReopenAccount:m}))};return e.jsxs(l,{style:{flexDirection:"row"},children:[t.bankId&&e.jsx("div",{style:{margin:"auto",marginRight:5,width:8,height:8,borderRadius:8,flexShrink:0,backgroundColor:n?a.sidebarItemBackgroundPending:i?a.sidebarItemBackgroundFailed:a.sidebarItemBackgroundPositive,transition:"transform .3s"}}),e.jsx(C,{style:{...A.underlinedText,...A.lineClamp(2)},onClick:p,children:`${t.closed?"Closed: ":""}${t.name}`})]})}function xn({account:t}){const[n,i]=T.useState(),[s,c]=T.useState(!1),[f,r]=T.useState(!0),[g,m]=T.useState([]),p=Ot(),u=T.useMemo(()=>s?g:p.concat(g),[s,p,g]),h=Bt()||"MM/dd/yyyy";U("numberFormat");const y=ne(),x=xe(),L=async()=>{await y(Oe(t.id))},o=T.useCallback(()=>It(t.id).options({splits:"none"}),[t.id]),S=T.useRef(null),I=T.useCallback(v=>{S.current?.unsubscribe(),r(!0),S.current=kt(v.options({splits:"none"}).select("*"),E=>{m(E),r(!1)},{pageCount:50})},[]),k=T.useCallback(()=>{const v=o();i(v),I(v)},[o,I]),M=()=>{S.current?.run()};T.useEffect(()=>{const v=$e("sync-event",({type:E,tables:N})=>{E==="applied"&&((N.includes("transactions")||N.includes("category_mapping")||N.includes("payee_mapping"))&&M(),(N.includes("payees")||N.includes("payee_mapping"))&&y(Pt()))});return k(),y(At(t.id)),()=>v()},[t.id,y,k]);const _=Ft(T.useCallback(v=>{v===""&&n?I(n):v&&n&&I(Wt(n,v,h)),c(v!=="")},[n,h,I]),150),V=v=>{_(v)},w=v=>{Lt(v.id)?y(P("scheduled-transaction-menu",{transactionId:v.id,onPost:async E=>{const N=E.split("/");await Z("schedule/post-transaction",{id:N[1]}),y($("scheduled-transaction-menu"))},onSkip:async E=>{const N=E.split("/");await Z("schedule/skip-next-date",{id:N[1]}),y($("scheduled-transaction-menu"))}})):x(`/transactions/${v.id}`)},F=()=>{S.current?.fetchNext()},q=Ee(t),K=zt(t),X=Rt(t);return e.jsx(Mt,{isLoading:f,transactions:u,balance:q,balanceCleared:K,balanceUncleared:X,onLoadMore:F,searchPlaceholder:`Search ${t.name}`,onSearch:V,onOpenTransaction:w,onRefresh:L})}function pn(){const t=Ne(),n=Be(m=>m.account.accountsSyncing),i=xe(),[s]=U("numberFormat"),c=s||"comma-dot",[f=!1]=U("hideFraction"),{id:r}=$t();ve(a.mobileViewTheme);const g=Et(r);return g?r==="budgeted"||r==="offbudget"||r==="uncategorized"?e.jsxs(l,{style:{flex:1,padding:30},children:[e.jsx(C,{style:{textAlign:"center"},children:"There is no Mobile View at the moment"}),e.jsx(Nt,{type:"normal",style:{fontSize:15,marginLeft:10,marginTop:10},onClick:()=>i("/accounts"),children:"Go back to Mobile Accounts"})]}):e.jsx(cn,{account:g,pending:n.includes(g.id),failed:t&&t.has(g.id)},c+f):null}export{pn as Account,hn as Accounts,fn as Budget};
//# sourceMappingURL=narrow.1I7NjHhw.chunk.js.map
